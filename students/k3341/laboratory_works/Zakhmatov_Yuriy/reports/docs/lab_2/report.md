# Ð›Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð° 2

---

## Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð³Ð¾ ÑÐ°Ð¹Ñ‚Ð° ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð°Ð¼Ð¸ DJANGO

**Ð¦ÐµÐ»ÑŒ**: ÐžÐ²Ð»Ð°Ð´ÐµÑ‚ÑŒ Ð¿Ñ€Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð½Ð°Ð²Ñ‹ÐºÐ°Ð¼Ð¸ Ð¸ ÑƒÐ¼ÐµÐ½Ð¸ÑÐ¼Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ web-ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²
ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð°Ð¼Ð¸ Django 2.2.

**ÐŸÑ€Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ:** Ð ÐµÐ°Ð»Ð¸Ñ‰Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ°Ð¹Ñ‚ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº Django 3 Ð¸ Ð¡Ð£Ð‘Ð” PostgreSQL *, Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ñ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð¼ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹.

**Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚:** 2 (8 Ð½Ð¾Ð¼ÐµÑ€ Ð² Ð¶ÑƒÑ€Ð½Ð°Ð»Ðµ)

**Ð”Ð¾ÑÐºÐ° Ð´Ð¾Ð¼Ð°ÑˆÐ½Ð¸Ñ… Ð·Ð°Ð´Ð°Ð½Ð¸Ð¹.**

Ðž Ð´Ð¾Ð¼Ð°ÑˆÐ½ÐµÐ¼ Ð·Ð°Ð´Ð°Ð½Ð¸Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ð° Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒÑÑ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ: Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚,
Ð¿Ñ€ÐµÐ¿Ð¾Ð´Ð°Ð²Ð°Ñ‚ÐµÐ»ÑŒ, Ð´Ð°Ñ‚Ð° Ð²Ñ‹Ð´Ð°Ñ‡Ð¸, Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ, Ñ‚ÐµÐºÑÑ‚ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ, Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ ÑˆÑ‚Ñ€Ð°Ñ„Ð°Ñ….
ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»:

* Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹.
* ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð´Ð¾Ð¼Ð°ÑˆÐ½Ð¸Ñ… Ð·Ð°Ð´Ð°Ð½Ð¸Ð¹ Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð´Ð¸ÑÑ†Ð¸Ð¿Ð»Ð¸Ð½Ð°Ð¼ (ÑÑ€Ð¾ÐºÐ¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ, Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ).
* Ð¡Ð´Ð°Ñ‡Ð° Ð´Ð¾Ð¼Ð°ÑˆÐ½Ð¸Ñ… Ð·Ð°Ð´Ð°Ð½Ð¸Ð¹ Ð² Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¾Ð¼ Ð²Ð¸Ð´Ðµ.
* ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ (ÑƒÑ‡Ð¸Ñ‚ÐµÐ»ÑŒ) Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¸Ð¼ÐµÑ‚ÑŒ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ†ÐµÐ½ÐºÑƒ Ð·Ð° Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð°Ð¼Ð¸ Django-admin.
* Ð’ ÐºÐ»Ð¸ÐµÐ½Ñ‚ÑÐºÐ¾Ð¹ Ñ‡Ð°ÑÑ‚Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ð° Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°, Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÑŽÑ‰Ð°Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¸
Ð²ÑÐµÑ… ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ¾Ð² ÐºÐ»Ð°ÑÑÐ°.

---
 
## Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

1. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð‘Ð” Ð½Ð°ÑˆÐµÐ³Ð¾ ÑÐ°Ð¹Ñ‚Ð°:

~~~python
from django.db import models
from django.contrib.auth.models import User

# Create your models here.

class Subject(models.Model):
    name = models.CharField(max_length=30)
    teacher = models.CharField(max_length=30)
    teacher_email = models.EmailField()

    def __str__(self):
        return self.name

class Homework(models.Model):
    subject = models.ForeignKey(Subject,on_delete=models.CASCADE)
    issue_date = models.DateField()
    due_date = models.DateField()
    description = models.TextField()
    penalty_info = models.TextField(blank=True, null=True)

    def __str__(self):
        return f"{self.subject.name}: {self.description[:100]}"

    def get_last_submission(self, user):
        """Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÑŽÑŽ ÑÐ´Ð°Ñ‡Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ"""
        return self.submission_set.filter(student=user).order_by('-submitted_at').first()


class Submission(models.Model):
    HOMEWORK_STATUS = [
        ('submitted', 'ðŸ“¤ Ð¡Ð´Ð°Ð½Ð¾'),
        ('graded', 'âœ… ÐžÑ†ÐµÐ½ÐµÐ½Ð¾'),
        ('late', 'âš ï¸ Ð¡Ð´Ð°Ð½Ð¾ Ñ Ð¾Ð¿Ð¾Ð·Ð´Ð°Ð½Ð¸ÐµÐ¼'),
        ('not_submitted', 'â³ ÐÐµ ÑÐ´Ð°Ð½Ð¾'),
    ]

    homework = models.ForeignKey(Homework, on_delete=models.CASCADE)
    student = models.ForeignKey(User, on_delete=models.CASCADE)
    text = models.TextField()
    submitted_at = models.DateTimeField(auto_now_add=True)
    grade = models.PositiveSmallIntegerField(null=True, blank=True)
    status = models.CharField(
        max_length=20,
        choices=HOMEWORK_STATUS,
        default='not_submitted'
    )

    def save(self, *args, **kwargs):
        # Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ñ€Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ save, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð»Ð¸ÑÑŒ auto_now_add Ð¿Ð¾Ð»Ñ
        super().save(*args, **kwargs)

        # Ð—Ð°Ñ‚ÐµÐ¼ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ‚ÑƒÑ, ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾
        if self.submitted_at and self.homework.due_date:
            if self.submitted_at.date() > self.homework.due_date:
                self.status = 'late'
            elif self.grade is not None:
                self.status = 'graded'
            elif self.text:
                self.status = 'submitted'
        elif self.grade is not None:
            self.status = 'graded'

        # Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÐ½Ð¾Ð²Ð°, ÐµÑÐ»Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»ÑÑ
        if self._state.adding is False:  # Ð•ÑÐ»Ð¸ Ð¾Ð±ÑŠÐµÐºÑ‚ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚
            super().save(update_fields=['status'])

    def __str__(self):
        return f"{self.student.username} - {self.homework.subject.name} ({self.get_status_display()})"
~~~

2. ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ Ð‘Ð”

![img.png](screenshots%2Fimg.png)

3. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð°Ð´Ð¼Ð¸Ð½ÐºÑƒ

```python
from django.contrib import admin
from .models import Subject, Homework, Submission

# Register your models here.

@admin.register(Subject)
class SubjectAdmin(admin.ModelAdmin):
    list_display = ('name', 'teacher')

@admin.register(Homework)
class HomeworkAdmin(admin.ModelAdmin):
    list_display = ('subject', 'issue_date', 'due_date')
    list_filter = ('subject',)

@admin.register(Submission)
class SubmissionAdmin(admin.ModelAdmin):
    list_display = ('homework', 'student', 'status', 'grade', 'submitted_at')
    list_filter = ('homework', 'grade', 'status')
    search_fields = ('student__username', 'student__first_name', 'student__last_name')
    list_editable = ('status', 'grade')
    actions = ['delete_old_submissions']

    def delete_old_submissions(self, request, queryset):
        """Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ð²ÑÐµ ÐºÑ€Ð¾Ð¼Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… ÑÐ´Ð°Ñ‡"""
        from django.db.models import Max

        # ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ ID Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… ÑÐ´Ð°Ñ‡ Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð° Ð¸ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ
        latest_submissions = Submission.objects.values(
            'student', 'homework'
        ).annotate(
            latest_id=Max('id')
        ).values_list('latest_id', flat=True)

        # Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð²ÑÐµ ÐºÑ€Ð¾Ð¼Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ…
        deleted_count = Submission.objects.exclude(
            id__in=latest_submissions
        ).delete()[0]

        self.message_user(request, f"Ð£Ð´Ð°Ð»ÐµÐ½Ð¾ {deleted_count} ÑÑ‚Ð°Ñ€Ñ‹Ñ… ÑÐ´Ð°Ñ‡")

    delete_old_submissions.short_description = "Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²ÑÐµ ÐºÑ€Ð¾Ð¼Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… ÑÐ´Ð°Ñ‡"
```

4. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ

```python
from django.http import HttpResponseRedirect
from django.shortcuts import render
from django.contrib.auth.forms import UserCreationForm
from django.contrib.auth import login
from django.contrib.auth.decorators import login_required
from django.core.paginator import Paginator
from django.db.models import Q
from .models import Homework, Submission
from django.contrib.auth.models import User

# Create your views here.

#Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ
def register(request):
    if request.method == 'POST':
        form = UserCreationForm(request.POST)
        if form.is_valid():
            user = form.save()
            login(request, user)
            return HttpResponseRedirect('/')
    else:
        form = UserCreationForm()
    return render(request, 'tasks/register.html', {'form': form})


#Ð´Ð¾Ð¼Ð°ÑˆÐ½ÑÑ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð°
@login_required(login_url='login')
def home(request):
    if not request.user.is_authenticated:
        return HttpResponseRedirect('register')

    query = request.GET.get('q')
    homeworks = Homework.objects.all().order_by('-due_date')

    if query:
        homeworks = homeworks.filter(
            Q(subject__name__icontains=query) |
            Q(description__icontains=query) |
            Q(subject__teacher__icontains=query)
        )

    paginator = Paginator(homeworks, 5)
    page_number = request.GET.get('page')
    page_obj = paginator.get_page(page_number)

    return render(request, 'tasks/home.html', {'page_obj': page_obj})


#Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð´Ð°Ð½Ð¸Ñ
@login_required
def submit_homework(request, homework_id):
    homework = Homework.objects.get(id=homework_id)
    if request.method == 'POST':
        text = request.POST.get("text")
        submission = Submission.objects.create(
            homework=homework,
            student=request.user,
            text=text
        )
        return HttpResponseRedirect('/')
    return render(request, 'tasks/submit.html', {'homework': homework})


#Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ñ†ÐµÐ½Ð¾Ðº Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
@login_required
def my_grades(request):
    """Ð›Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¾Ñ†ÐµÐ½ÐºÐ¸ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ"""
    # Ð‘ÐµÑ€ÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ ÑÐ´Ð°Ñ‡Ð¸ Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ
    from django.db.models import Max
    latest_submissions = Submission.objects.filter(
        student=request.user
    ).values(
        'homework'
    ).annotate(
        latest_id=Max('id')
    ).values_list('latest_id', flat=True)

    submissions = Submission.objects.filter(id__in=latest_submissions)
    return render(request, 'tasks/my_grades.html', {'submissions': submissions})


#Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ñ†ÐµÐ½Ð¾Ðº ÐºÐ»Ð°ÑÑÐ°
@login_required
def class_grades(request):
    """Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¾Ñ†ÐµÐ½Ð¾Ðº Ð²ÑÐµÐ³Ð¾ ÐºÐ»Ð°ÑÑÐ°"""
    from django.db.models import Max

    # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ ID Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… ÑÐ´Ð°Ñ‡ Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð° Ð¸ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ
    latest_submissions = Submission.objects.values(
        'student', 'homework'
    ).annotate(
        latest_id=Max('id')
    ).values_list('latest_id', flat=True)

    # Ð‘ÐµÑ€ÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ ÑÐ´Ð°Ñ‡Ð¸
    all_submissions = Submission.objects.filter(id__in=latest_submissions)

    # Ð“Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð°Ð¼ Ð´Ð»Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹
    students = User.objects.all()
    homeworks = Homework.objects.all()

    # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹
    grades_data = []
    for student in students:
        student_grades = []
        total_grade = 0
        graded_count = 0

        for homework in homeworks:
            submission = all_submissions.filter(
                student=student,
                homework=homework
            ).first()
            grade = submission.grade if submission else None
            student_grades.append(grade)

            if grade is not None:
                total_grade += grade
                graded_count += 1

        # Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÐ¼ ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»
        average_grade = round(total_grade / graded_count, 1) if graded_count > 0 else None

        grades_data.append({
            'student': student,
            'grades': student_grades,
            'average_grade': average_grade
        })

    return render(request, 'tasks/class_grades.html', {
        'grades_data': grades_data,
        'homeworks': homeworks
    })
```

5. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ urls

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.home, name='home'),
    path('register/', views.register, name='register'),
    path('submit/<int:homework_id>/', views.submit_homework, name='submit_homework'),
    path('my-grades/', views.my_grades, name='my_grades'),
    path('class-grades/', views.class_grades, name='class_grades'),
]
```
 
##### Ð“Ð»Ð°Ð²Ð½Ñ‹Ð¹ urls

```python
from django.contrib import admin
from django.urls import path, include
from django.contrib.auth import views as auth_views

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('tasks.urls')),
    path('login/', auth_views.LoginView.as_view(template_name='tasks/login.html'), name='login'),
    path('logout/', auth_views.LogoutView.as_view(next_page='login'), name='logout'),
]

```





